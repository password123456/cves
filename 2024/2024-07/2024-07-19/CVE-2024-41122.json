{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2024-41122",
    "assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
    "state": "PUBLISHED",
    "assignerShortName": "GitHub_M",
    "dateReserved": "2024-07-15T15:53:28.323Z",
    "datePublished": "2024-07-19T19:58:41.180Z",
    "dateUpdated": "2024-07-19T19:58:41.180Z"
  },
  "containers": {
    "cna": {
      "title": "Custom environment variables allow to alter execution flow of plugins in Woodpecker",
      "problemTypes": [
        {
          "descriptions": [
            {
              "cweId": "CWE-74",
              "lang": "en",
              "description": "CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
              "type": "CWE"
            }
          ]
        }
      ],
      "metrics": [
        {
          "cvssV3_1": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "LOW",
            "scope": "UNCHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
          }
        }
      ],
      "references": [
        {
          "name": "https://github.com/woodpecker-ci/woodpecker/security/advisories/GHSA-3wf2-2pq4-4rvc",
          "tags": [
            "x_refsource_CONFIRM"
          ],
          "url": "https://github.com/woodpecker-ci/woodpecker/security/advisories/GHSA-3wf2-2pq4-4rvc"
        },
        {
          "name": "https://github.com/woodpecker-ci/woodpecker-security/issues/10",
          "tags": [
            "x_refsource_MISC"
          ],
          "url": "https://github.com/woodpecker-ci/woodpecker-security/issues/10"
        },
        {
          "name": "https://github.com/woodpecker-ci/woodpecker/issues/3929",
          "tags": [
            "x_refsource_MISC"
          ],
          "url": "https://github.com/woodpecker-ci/woodpecker/issues/3929"
        },
        {
          "name": "https://github.com/woodpecker-ci/woodpecker/pull/3909",
          "tags": [
            "x_refsource_MISC"
          ],
          "url": "https://github.com/woodpecker-ci/woodpecker/pull/3909"
        },
        {
          "name": "https://github.com/woodpecker-ci/woodpecker/pull/3934",
          "tags": [
            "x_refsource_MISC"
          ],
          "url": "https://github.com/woodpecker-ci/woodpecker/pull/3934"
        }
      ],
      "affected": [
        {
          "vendor": "woodpecker-ci",
          "product": "woodpecker",
          "versions": [
            {
              "version": "< 2.7.0",
              "status": "affected"
            }
          ]
        }
      ],
      "providerMetadata": {
        "orgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
        "shortName": "GitHub_M",
        "dateUpdated": "2024-07-19T19:58:41.180Z"
      },
      "descriptions": [
        {
          "lang": "en",
          "value": "Woodpecker is a simple yet powerful CI/CD engine with great extensibility. The server allow to create any user who can trigger a pipeline run malicious workflows: 1. Those workflows can either lead to a host takeover that runs the agent executing the workflow. 2. Or allow to extract the secrets who would be normally provided to the plugins who's entrypoint are overwritten. This issue has been addressed in release version 2.7.0. Users are advised to upgrade. There are no known workarounds for this vulnerability."
        }
      ],
      "source": {
        "advisory": "GHSA-3wf2-2pq4-4rvc",
        "discovery": "UNKNOWN"
      }
    }
  }
}