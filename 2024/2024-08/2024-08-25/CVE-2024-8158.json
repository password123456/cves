{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2024-8158",
    "assignerOrgId": "1d66c9f9-fff2-411a-aa19-ca6312fa25e9",
    "state": "PUBLISHED",
    "assignerShortName": "9front",
    "dateReserved": "2024-08-25T21:25:59.746Z",
    "datePublished": "2024-08-25T21:31:08.246Z",
    "dateUpdated": "2024-08-25T21:31:08.246Z"
  },
  "containers": {
    "cna": {
      "affected": [
        {
          "defaultStatus": "unaffected",
          "modules": [
            "lib9p",
            "hjfs"
          ],
          "product": "9front",
          "repo": "http://git.9front.org/plan9front/plan9front/HEAD/info.html",
          "vendor": "9front",
          "versions": [
            {
              "lessThan": "9645ae07eb66a59015e3e118d0024790c37400da",
              "status": "affected",
              "version": "0",
              "versionType": "Commit Hash"
            }
          ]
        }
      ],
      "credits": [
        {
          "lang": "en",
          "type": "finder",
          "value": "humm"
        },
        {
          "lang": "en",
          "type": "remediation developer",
          "value": "Jacob Moody"
        },
        {
          "lang": "en",
          "type": "remediation reviewer",
          "value": "cinap_lenrek"
        }
      ],
      "datePublic": "2024-08-24T21:58:00.000Z",
      "descriptions": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<div>A bug in the 9p authentication implementation within lib9p allows an attacker with an existing valid user within the configured auth server to impersonate any other valid filesystem user.</div><div>This is due to lib9p not properly verifying that the uname given in the Tauth and Tattach 9p messages matches the client UID returned from the factotum authentication handshake.<br></div><div>The only filesystem making use of these functions within the base 9front systems is the experimental hjfs disk filesystem, other disk filesystems (cwfs and gefs) are not affected by this bug.</div><div>This bug was inherited from Plan 9 and is present in all versions of 9front and is remedied fully in commit 9645ae07eb66a59015e3e118d0024790c37400da.<br></div>"
            }
          ],
          "value": "A bug in the 9p authentication implementation within lib9p allows an attacker with an existing valid user within the configured auth server to impersonate any other valid filesystem user.\n\nThis is due to lib9p not properly verifying that the uname given in the Tauth and Tattach 9p messages matches the client UID returned from the factotum authentication handshake.\n\n\nThe only filesystem making use of these functions within the base 9front systems is the experimental hjfs disk filesystem, other disk filesystems (cwfs and gefs) are not affected by this bug.\n\nThis bug was inherited from Plan 9 and is present in all versions of 9front and is remedied fully in commit 9645ae07eb66a59015e3e118d0024790c37400da."
        }
      ],
      "impacts": [
        {
          "capecId": "CAPEC-114",
          "descriptions": [
            {
              "lang": "en",
              "value": "CAPEC-114 Authentication Abuse"
            }
          ]
        }
      ],
      "metrics": [
        {
          "cvssV4_0": {
            "Automatable": "NO",
            "Recovery": "NOT_DEFINED",
            "Safety": "NOT_DEFINED",
            "attackComplexity": "LOW",
            "attackRequirements": "PRESENT",
            "attackVector": "NETWORK",
            "baseScore": 8.8,
            "baseSeverity": "HIGH",
            "privilegesRequired": "LOW",
            "providerUrgency": "RED",
            "subAvailabilityImpact": "NONE",
            "subConfidentialityImpact": "HIGH",
            "subIntegrityImpact": "HIGH",
            "userInteraction": "NONE",
            "valueDensity": "CONCENTRATED",
            "vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:N/SC:H/SI:H/SA:N/AU:N/V:C/RE:L/U:Red",
            "version": "4.0",
            "vulnAvailabilityImpact": "NONE",
            "vulnConfidentialityImpact": "HIGH",
            "vulnIntegrityImpact": "HIGH",
            "vulnerabilityResponseEffort": "LOW"
          },
          "format": "CVSS",
          "scenarios": [
            {
              "lang": "en",
              "value": "GENERAL"
            }
          ]
        }
      ],
      "problemTypes": [
        {
          "descriptions": [
            {
              "cweId": "CWE-639",
              "description": "CWE-639 Authorization Bypass Through User-Controlled Key",
              "lang": "en",
              "type": "CWE"
            }
          ]
        }
      ],
      "providerMetadata": {
        "orgId": "1d66c9f9-fff2-411a-aa19-ca6312fa25e9",
        "shortName": "9front",
        "dateUpdated": "2024-08-25T21:31:08.246Z"
      },
      "references": [
        {
          "tags": [
            "patch"
          ],
          "url": "https://git.9front.org/plan9front/plan9front/07aa9bfeef55ca987d411115adcfbbd4390ecf34/commit.html"
        }
      ],
      "solutions": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<div>Update 9front to at least commit 9645ae07eb66a59015e3e118d0024790c37400da and follow these update instructions:</div><div><br></div><div>1. Make and install the now patched version of lib9p.</div><div>2. Make and install the new patched version of hjfs.</div><div>3. Make and install the kernel to include the patched hjfs within the kernel's paqfs.<br></div>"
            }
          ],
          "value": "Update 9front to at least commit 9645ae07eb66a59015e3e118d0024790c37400da and follow these update instructions:\n\n\n\n\n1. Make and install the now patched version of lib9p.\n\n2. Make and install the new patched version of hjfs.\n\n3. Make and install the kernel to include the patched hjfs within the kernel's paqfs."
        }
      ],
      "source": {
        "discovery": "INTERNAL"
      },
      "title": "User impersonation for lib9p based 9p fileservers",
      "x_generator": {
        "engine": "Vulnogram 0.2.0"
      }
    }
  }
}