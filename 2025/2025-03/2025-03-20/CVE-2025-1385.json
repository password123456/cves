{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2025-1385",
    "assignerOrgId": "cb7ba516-3b07-4c98-b0c2-715220f1a8f6",
    "state": "PUBLISHED",
    "assignerShortName": "ClickHouse",
    "dateReserved": "2025-02-17T02:21:00.085Z",
    "datePublished": "2025-03-20T07:13:34.577Z",
    "dateUpdated": "2025-03-20T07:13:34.577Z"
  },
  "containers": {
    "cna": {
      "affected": [
        {
          "collectionURL": "https://github.com/ClickHouse/clickhouse",
          "defaultStatus": "unaffected",
          "modules": [
            "clickhouse-library-bridge"
          ],
          "packageName": "ClickHouse",
          "product": "ClickHouse OSS",
          "repo": "https://github.com/ClickHouse/clickhouse",
          "vendor": "ClickHouse",
          "versions": [
            {
              "lessThan": "24.3.18.6",
              "status": "affected",
              "version": "24.3",
              "versionType": "custom"
            },
            {
              "lessThan": "24.8.14.27",
              "status": "affected",
              "version": "24.8",
              "versionType": "custom"
            },
            {
              "lessThan": "24.11.5.34",
              "status": "affected",
              "version": "24.11",
              "versionType": "custom"
            },
            {
              "lessThan": "24.12.5.65",
              "status": "affected",
              "version": "24.12",
              "versionType": "custom"
            },
            {
              "lessThan": "25.1.5.5",
              "status": "affected",
              "version": "25.1",
              "versionType": "custom"
            }
          ]
        }
      ],
      "credits": [
        {
          "lang": "en",
          "type": "finder",
          "value": "Arseniy Dugin"
        }
      ],
      "datePublic": "2025-03-20T02:00:00.000Z",
      "descriptions": [
        {
          "lang": "en",
          "supportingMedia": [
            {
              "base64": false,
              "type": "text/html",
              "value": "<p>When the library bridge feature is enabled, the clickhouse-library-bridge exposes an HTTP API on localhost. This allows clickhouse-server to dynamically load a library from a specified path and execute it in an isolated process. Combined with the ClickHouse table engine functionality that permits file uploads to specific directories, a misconfigured server can be exploited by an attacker with privilege to access to both table engines to execute arbitrary code on the ClickHouse server.</p><p>You can check if your ClickHouse server is vulnerable to this vulnerability by inspecting the configuration file and confirming if the following setting is enabled:</p><div><pre><code>&lt;library_bridge&gt;\n   &lt;port&gt;9019&lt;/port&gt;\n&lt;/library_bridge&gt;</code></pre></div><br>"
            }
          ],
          "value": "When the library bridge feature is enabled, the clickhouse-library-bridge exposes an HTTP API on localhost. This allows clickhouse-server to dynamically load a library from a specified path and execute it in an isolated process. Combined with the ClickHouse table engine functionality that permits file uploads to specific directories, a misconfigured server can be exploited by an attacker with privilege to access to both table engines to execute arbitrary code on the ClickHouse server.\n\nYou can check if your ClickHouse server is vulnerable to this vulnerability by inspecting the configuration file and confirming if the following setting is enabled:\n\n<library_bridge>\n   <port>9019</port>\n</library_bridge>"
        }
      ],
      "impacts": [
        {
          "capecId": "CAPEC-108",
          "descriptions": [
            {
              "lang": "en",
              "value": "CAPEC-108 Command Line Execution through SQL Injection"
            }
          ]
        }
      ],
      "metrics": [
        {
          "cvssV4_0": {
            "Automatable": "NOT_DEFINED",
            "Recovery": "NOT_DEFINED",
            "Safety": "NOT_DEFINED",
            "attackComplexity": "HIGH",
            "attackRequirements": "NONE",
            "attackVector": "NETWORK",
            "baseScore": 7.5,
            "baseSeverity": "HIGH",
            "privilegesRequired": "HIGH",
            "providerUrgency": "NOT_DEFINED",
            "subAvailabilityImpact": "NONE",
            "subConfidentialityImpact": "NONE",
            "subIntegrityImpact": "NONE",
            "userInteraction": "NONE",
            "valueDensity": "NOT_DEFINED",
            "vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N",
            "version": "4.0",
            "vulnAvailabilityImpact": "HIGH",
            "vulnConfidentialityImpact": "HIGH",
            "vulnIntegrityImpact": "HIGH",
            "vulnerabilityResponseEffort": "NOT_DEFINED"
          },
          "format": "CVSS",
          "scenarios": [
            {
              "lang": "en",
              "value": "GENERAL"
            }
          ]
        }
      ],
      "problemTypes": [
        {
          "descriptions": [
            {
              "cweId": "CWE-20",
              "description": "CWE-20 Improper Input Validation",
              "lang": "en",
              "type": "CWE"
            }
          ]
        }
      ],
      "providerMetadata": {
        "orgId": "cb7ba516-3b07-4c98-b0c2-715220f1a8f6",
        "shortName": "ClickHouse",
        "dateUpdated": "2025-03-20T07:13:34.577Z"
      },
      "references": [
        {
          "url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-5phv-x8x4-83x5"
        }
      ],
      "source": {
        "discovery": "UNKNOWN"
      },
      "title": "Fail input validation in clickhouse-library-bridge API could lead to RCE under specific configuration",
      "x_generator": {
        "engine": "Vulnogram 0.2.0"
      }
    }
  }
}